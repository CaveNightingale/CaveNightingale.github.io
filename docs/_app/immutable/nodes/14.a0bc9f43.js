import{S as B,i as C,s as D,k as F,a as U,q as j,l as E,m as y,h as p,c as H,r as N,n as d,b as O,D as _,u as z,E as L,o as Y}from"../chunks/index.2a7a30eb.js";import{c as G}from"../chunks/common.e1899131.js";const W=`#pragma vscode_glsllint_stage : vert

attribute vec4 aVertexPosition;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

void main() {
	gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
}`,k=`#pragma vscode_glsllint_stage : frag

void main() {
	gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
}`;var b=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function w(){var e=new b(16);return b!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function q(e,r,n){var a=n[0],i=n[1],s=n[2],o,c,l,h,f,g,u,x,A,P,M,S;return r===e?(e[12]=r[0]*a+r[4]*i+r[8]*s+r[12],e[13]=r[1]*a+r[5]*i+r[9]*s+r[13],e[14]=r[2]*a+r[6]*i+r[10]*s+r[14],e[15]=r[3]*a+r[7]*i+r[11]*s+r[15]):(o=r[0],c=r[1],l=r[2],h=r[3],f=r[4],g=r[5],u=r[6],x=r[7],A=r[8],P=r[9],M=r[10],S=r[11],e[0]=o,e[1]=c,e[2]=l,e[3]=h,e[4]=f,e[5]=g,e[6]=u,e[7]=x,e[8]=A,e[9]=P,e[10]=M,e[11]=S,e[12]=o*a+f*i+A*s+r[12],e[13]=c*a+g*i+P*s+r[13],e[14]=l*a+u*i+M*s+r[14],e[15]=h*a+x*i+S*s+r[15]),e}function K(e,r,n){var a=n[0],i=n[1],s=n[2];return e[0]=r[0]*a,e[1]=r[1]*a,e[2]=r[2]*a,e[3]=r[3]*a,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=r[7]*i,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=r[11]*s,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Q(e,r,n,a,i){var s=1/Math.tan(r/2),o;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(a-i),e[10]=(i+a)*o,e[14]=2*i*a*o):(e[10]=-1,e[14]=-2*a),e}var X=Q;let t,m,v,V,R,T;function J(e,r){t=e,m=r;const n=ee();n&&(v=n,R={vertexPosition:t.getAttribLocation(v,"aVertexPosition")},T={projectionMatrix:t.getUniformLocation(v,"uProjectionMatrix"),modelViewMatrix:t.getUniformLocation(v,"uModelViewMatrix")},$(),Z())}function Z(){t.clearColor(0,0,0,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const e=90*Math.PI/180,r=t.canvas.clientWidth/t.canvas.clientHeight,n=100,a=.1,i=w();X(i,e,r,a,n);const s=w();q(s,s,[0,0,-6]),K(s,s,[2,2,2]);const o=2,c=t.FLOAT,l=!1,h=0,f=0;t.bindBuffer(t.ARRAY_BUFFER,V.position),t.vertexAttribPointer(R.vertexPosition,o,c,l,h,f),t.enableVertexAttribArray(R.vertexPosition),t.useProgram(v),t.uniformMatrix4fv(T.projectionMatrix,!1,i),t.uniformMatrix4fv(T.modelViewMatrix,!1,s);const g=4;t.drawArrays(t.TRIANGLE_STRIP,f,g)}function $(){const e=t.createBuffer();if(!e)return m.error("Failed to create buffer"),null;t.bindBuffer(t.ARRAY_BUFFER,e);const r=[1,1,-1,1,1,-1,-1,-1];t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),V={position:e}}function ee(){const e=I(t.VERTEX_SHADER,W),r=I(t.FRAGMENT_SHADER,k);if(!e||!r)return null;const n=t.createProgram();return n?(t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)?n:(m.error("Failed to link shader program: "+t.getProgramInfoLog(n)),t.deleteProgram(n),null)):(m.error("Failed to create shader program"),null)}function I(e,r){const n=t.createShader(e);return n?(t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(m.error("Failed to compile shader: "+t.getShaderInfoLog(n)),t.deleteShader(n),null)):(m.error("Failed to create shader"),null)}function re(e){let r,n,a,i,s;return{c(){r=F("div"),n=F("canvas"),a=U(),i=F("div"),s=j(e[0]),this.h()},l(o){r=E(o,"DIV",{id:!0,class:!0});var c=y(r);n=E(c,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),y(n).forEach(p),a=H(c),i=E(c,"DIV",{});var l=y(i);s=N(l,e[0]),l.forEach(p),c.forEach(p),this.h()},h(){d(n,"id","canvas"),d(n,"width","800"),d(n,"height","600"),d(n,"class","svelte-1ya6r2a"),d(r,"id","container"),d(r,"class","svelte-1ya6r2a")},m(o,c){O(o,r,c),_(r,n),_(r,a),_(r,i),_(i,s)},p(o,[c]){c&1&&z(s,o[0])},i:L,o:L,d(o){o&&p(r)}}}function te(e,r,n){G("WebGL 样例","/",!1,!0);let a="";function i(){let s=document.getElementById("canvas");if(!(s instanceof HTMLCanvasElement)){n(0,a="Canvas not found");return}let o=s.getContext("webgl");if(!o){n(0,a="WebGL not supported");return}J(o,{error:c=>{n(0,a=c)}})}return Y(i),[a]}class ie extends B{constructor(r){super(),C(this,r,te,re,D,{})}}export{ie as component};
