import{S as ae,i as ce,s as pe,J as He,k as L,l as A,m as F,h as p,n as y,b as D,L as Re,M as qe,N as We,g as J,d as j,q as M,r as T,D as m,H as X,u as re,E as fe,I as ie,e as se,v as Ae,f as De,y as Y,z as Q,A as Z,B as K,a as W,c as G,o as Fe,P as Ge,Q as Se,R as Ue,p as he,T as xe,w as we,O as Je,U as be,V as Ve,W as Ee}from"../chunks/index.2a7a30eb.js";import{d as je,c as Xe,t as ve}from"../chunks/common.e1899131.js";import{S as te,P as Ye}from"../chunks/PlainTextView.38d97086.js";/* empty css                                                        */import{M as Qe}from"../chunks/MainContext.f47e6593.js";function Ze(l){let e,n;const t=l[1].default,r=He(t,l,l[0],null);return{c(){e=L("footer"),r&&r.c(),this.h()},l(s){e=A(s,"FOOTER",{class:!0});var i=F(e);r&&r.l(i),i.forEach(p),this.h()},h(){y(e,"class","svelte-vofmx1")},m(s,i){D(s,e,i),r&&r.m(e,null),n=!0},p(s,[i]){r&&r.p&&(!n||i&1)&&Re(r,t,s,s[0],n?We(t,s[0],i,null):qe(s[0]),null)},i(s){n||(J(r,s),n=!0)},o(s){j(r,s),n=!1},d(s){s&&p(e),r&&r.d(s)}}}function Ke(l,e,n){let{$$slots:t={},$$scope:r}=e;return l.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class et extends ae{constructor(e){super(),ce(this,e,Ke,Ze,pe,{})}}function tt(l){let e,n,t,r,s;return{c(){e=L("div"),n=L("div"),t=M(l[0]),this.h()},l(i){e=A(i,"DIV",{class:!0});var o=F(e);n=A(o,"DIV",{class:!0});var f=F(n);t=T(f,l[0]),f.forEach(p),o.forEach(p),this.h()},h(){y(n,"class","inner svelte-l13ml6"),y(e,"class","outer svelte-l13ml6")},m(i,o){D(i,e,o),m(e,n),m(n,t),r||(s=[X(e,"click",l[1]),X(e,"keypress",nt)],r=!0)},p(i,[o]){o&1&&re(t,i[0])},i:fe,o:fe,d(i){i&&p(e),r=!1,ie(s)}}}const nt=()=>{};function rt(l,e,n){let{href:t}=e,{content:r}=e;function s(){typeof t=="string"?open(t,"_self"):t()}return l.$$set=i=>{"href"in i&&n(2,t=i.href),"content"in i&&n(0,r=i.content)},[r,s,t]}class st extends ae{constructor(e){super(),ce(this,e,rt,tt,pe,{href:2,content:0})}}function le(){}le.prototype={diff:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.callback;typeof t=="function"&&(r=t,t={}),this.options=t;var s=this;function i(_){return r?(setTimeout(function(){r(void 0,_)},0),!0):_}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var o=n.length,f=e.length,a=1,d=o+f;t.maxEditLength&&(d=Math.min(d,t.maxEditLength));var u=[{newPos:-1,components:[]}],c=this.extractCommon(u[0],n,e,0);if(u[0].newPos+1>=o&&c+1>=f)return i([{value:this.join(n),count:n.length}]);function v(){for(var _=-1*a;_<=a;_+=2){var $=void 0,k=u[_-1],B=u[_+1],x=(B?B.newPos:0)-_;k&&(u[_-1]=void 0);var O=k&&k.newPos+1<o,H=B&&0<=x&&x<f;if(!O&&!H){u[_]=void 0;continue}if(!O||H&&k.newPos<B.newPos?($=it(B),s.pushComponent($.components,void 0,!0)):($=k,$.newPos++,s.pushComponent($.components,!0,void 0)),x=s.extractCommon($,n,e,_),$.newPos+1>=o&&x+1>=f)return i(lt(s,$.components,n,e,s.useLongestToken));u[_]=$}a++}if(r)(function _(){setTimeout(function(){if(a>d)return r();v()||_()},0)})();else for(;a<=d;){var E=v();if(E)return E}},pushComponent:function(e,n,t){var r=e[e.length-1];r&&r.added===n&&r.removed===t?e[e.length-1]={count:r.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,r){for(var s=n.length,i=t.length,o=e.newPos,f=o-r,a=0;o+1<s&&f+1<i&&this.equals(n[o+1],t[f+1]);)o++,f++,a++;return a&&e.components.push({count:a}),e.newPos=o,f},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function lt(l,e,n,t,r){for(var s=0,i=e.length,o=0,f=0;s<i;s++){var a=e[s];if(a.removed){if(a.value=l.join(t.slice(f,f+a.count)),f+=a.count,s&&e[s-1].added){var u=e[s-1];e[s-1]=e[s],e[s]=u}}else{if(!a.added&&r){var d=n.slice(o,o+a.count);d=d.map(function(v,E){var _=t[f+E];return _.length>v.length?_:v}),a.value=l.join(d)}else a.value=l.join(n.slice(o,o+a.count));o+=a.count,a.added||(f+=a.count)}}var c=e[i-1];return i>1&&typeof c.value=="string"&&(c.added||c.removed)&&l.equals("",c.value)&&(e[i-2].value+=c.value,e.pop()),e}function it(l){return{newPos:l.newPos,components:l.components.slice(0)}}var Ce=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,ke=/\S/,ze=new le;ze.equals=function(l,e){return this.options.ignoreCase&&(l=l.toLowerCase(),e=e.toLowerCase()),l===e||this.options.ignoreWhitespace&&!ke.test(l)&&!ke.test(e)};ze.tokenize=function(l){for(var e=l.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<e.length-1;n++)!e[n+1]&&e[n+2]&&Ce.test(e[n])&&Ce.test(e[n+2])&&(e[n]+=e[n+2],e.splice(n+1,2),n--);return e};var Ne=new le;Ne.tokenize=function(l){var e=[],n=l.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var t=0;t<n.length;t++){var r=n[t];t%2&&!this.options.newlineIsToken?e[e.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),e.push(r))}return e};var ot=new le;ot.tokenize=function(l){return l.split(/(\S.+?[.!?])(?=\s+|$)/)};var ft=new le;ft.tokenize=function(l){return l.split(/([{}:;,]|\s+)/)};function de(l){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?de=function(e){return typeof e}:de=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(l)}var ut=Object.prototype.toString,ue=new le;ue.useLongestToken=!0;ue.tokenize=Ne.tokenize;ue.castInput=function(l){var e=this.options,n=e.undefinedReplacement,t=e.stringifyReplacer,r=t===void 0?function(s,i){return typeof i>"u"?n:i}:t;return typeof l=="string"?l:JSON.stringify($e(l,null,null,r),r,"  ")};ue.equals=function(l,e){return le.prototype.equals.call(ue,l.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function $e(l,e,n,t,r){e=e||[],n=n||[],t&&(l=t(r,l));var s;for(s=0;s<e.length;s+=1)if(e[s]===l)return n[s];var i;if(ut.call(l)==="[object Array]"){for(e.push(l),i=new Array(l.length),n.push(i),s=0;s<l.length;s+=1)i[s]=$e(l[s],e,n,t,r);return e.pop(),n.pop(),i}if(l&&l.toJSON&&(l=l.toJSON()),de(l)==="object"&&l!==null){e.push(l),i={},n.push(i);var o=[],f;for(f in l)l.hasOwnProperty(f)&&o.push(f);for(o.sort(),s=0;s<o.length;s+=1)f=o[s],i[f]=$e(l[f],e,n,t,f);e.pop(),n.pop()}else i=l;return i}var ge=new le;ge.tokenize=function(l){return l.slice()};ge.join=ge.removeEmpty=function(l){return l};function at(l){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=l.split(/\r\n|[\n\v\f\r\x85]/),t=l.match(/\r\n|[\n\v\f\r\x85]/g)||[],r=[],s=0;function i(){var a={};for(r.push(a);s<n.length;){var d=n[s];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var u=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);u&&(a.index=u[1]),s++}for(o(a),o(a),a.hunks=[];s<n.length;){var c=n[s];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))a.hunks.push(f());else{if(c&&e.strict)throw new Error("Unknown line "+(s+1)+" "+JSON.stringify(c));s++}}}function o(a){var d=/^(---|\+\+\+)\s+(.*)$/.exec(n[s]);if(d){var u=d[1]==="---"?"old":"new",c=d[2].split("	",2),v=c[0].replace(/\\\\/g,"\\");/^".*"$/.test(v)&&(v=v.substr(1,v.length-2)),a[u+"FileName"]=v,a[u+"Header"]=(c[1]||"").trim(),s++}}function f(){var a=s,d=n[s++],u=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),c={oldStart:+u[1],oldLines:typeof u[2]>"u"?1:+u[2],newStart:+u[3],newLines:typeof u[4]>"u"?1:+u[4],lines:[],linedelimiters:[]};c.oldLines===0&&(c.oldStart+=1),c.newLines===0&&(c.newStart+=1);for(var v=0,E=0;s<n.length&&!(n[s].indexOf("--- ")===0&&s+2<n.length&&n[s+1].indexOf("+++ ")===0&&n[s+2].indexOf("@@")===0);s++){var _=n[s].length==0&&s!=n.length-1?" ":n[s][0];if(_==="+"||_==="-"||_===" "||_==="\\")c.lines.push(n[s]),c.linedelimiters.push(t[s]||`
`),_==="+"?v++:_==="-"?E++:_===" "&&(v++,E++);else break}if(!v&&c.newLines===1&&(c.newLines=0),!E&&c.oldLines===1&&(c.oldLines=0),e.strict){if(v!==c.newLines)throw new Error("Added line count did not match for hunk at line "+(a+1));if(E!==c.oldLines)throw new Error("Removed line count did not match for hunk at line "+(a+1))}return c}for(;s<n.length;)i();return r}function ct(l,e,n){var t=!0,r=!1,s=!1,i=1;return function o(){if(t&&!s){if(r?i++:t=!1,l+i<=n)return i;s=!0}if(!r)return s||(t=!0),e<=l-i?-i++:(r=!0,o())}}function pt(l,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=at(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var t=l.split(/\r\n|[\n\v\f\r\x85]/),r=l.match(/\r\n|[\n\v\f\r\x85]/g)||[],s=e.hunks,i=n.compareLine||function(I,w,U,S){return w===S},o=0,f=n.fuzzFactor||0,a=0,d=0,u,c;function v(I,w){for(var U=0;U<I.lines.length;U++){var S=I.lines[U],R=S.length>0?S[0]:" ",ee=S.length>0?S.substr(1):S;if(R===" "||R==="-"){if(!i(w+1,t[w],R,ee)&&(o++,o>f))return!1;w++}}return!0}for(var E=0;E<s.length;E++){for(var _=s[E],$=t.length-_.oldLines,k=0,B=d+_.oldStart-1,x=ct(B,a,$);k!==void 0;k=x())if(v(_,B+k)){_.offset=d+=k;break}if(k===void 0)return!1;a=_.offset+_.oldStart+_.oldLines}for(var O=0,H=0;H<s.length;H++){var z=s[H],b=z.oldStart+z.offset+O-1;O+=z.newLines-z.oldLines;for(var g=0;g<z.lines.length;g++){var P=z.lines[g],h=P.length>0?P[0]:" ",C=P.length>0?P.substr(1):P,N=z.linedelimiters[g];if(h===" ")b++;else if(h==="-")t.splice(b,1),r.splice(b,1);else if(h==="+")t.splice(b,0,C),r.splice(b,0,N),b++;else if(h==="\\"){var V=z.lines[g-1]?z.lines[g-1][0]:null;V==="+"?u=!0:V==="-"&&(c=!0)}}}if(u)for(;!t[t.length-1];)t.pop(),r.pop();else c&&(t.push(""),r.push(`
`));for(var q=0;q<t.length-1;q++)t[q]=t[q]+r[q];return t.join("")}function dt(l){let e,n;return e=new te({props:{$$slots:{default:[$t]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&130&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ht(l){let e,n;return e=new te({props:{$$slots:{default:[gt]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&131&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function mt(l){let e,n;return e=new te({props:{$$slots:{default:[yt]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&128&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function _t(l){let e,n;return e=new te({props:{$$slots:{default:[wt]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&129&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function vt(l){let e,n;return e=new st({props:{content:"安装用户脚本",href:l[4]}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.href=t[4]),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function $t(l){let e,n,t,r;return{c(){e=L("p"),n=M("出现了一个错误："),t=W(),r=M(l[1]),this.h()},l(s){e=A(s,"P",{class:!0});var i=F(e);n=T(i,"出现了一个错误："),i.forEach(p),t=G(s),r=T(s,l[1]),this.h()},h(){y(e,"class","svelte-xxdyl3")},m(s,i){D(s,e,i),m(e,n),D(s,t,i),D(s,r,i)},p(s,i){i&2&&re(r,s[1])},d(s){s&&p(e),s&&p(t),s&&p(r)}}}function gt(l){let e,n,t,r,s,i,o,f,a,d,u,c,v,E,_;return c=new Ye({props:{data:l[1]}}),{c(){e=L("p"),n=M("将以下内容复制到TamperMonkey的“添加新脚本’页面中，然后保存。"),t=W(),r=L("p"),s=L("button"),i=M("复制"),o=W(),f=L("button"),a=M("取消"),d=W(),u=L("p"),Y(c.$$.fragment),this.h()},l($){e=A($,"P",{class:!0});var k=F(e);n=T(k,"将以下内容复制到TamperMonkey的“添加新脚本’页面中，然后保存。"),k.forEach(p),t=G($),r=A($,"P",{class:!0});var B=F(r);s=A(B,"BUTTON",{class:!0});var x=F(s);i=T(x,"复制"),x.forEach(p),o=G(B),f=A(B,"BUTTON",{class:!0});var O=F(f);a=T(O,"取消"),O.forEach(p),B.forEach(p),d=G($),u=A($,"P",{class:!0});var H=F(u);Q(c.$$.fragment,H),H.forEach(p),this.h()},h(){y(e,"class","svelte-xxdyl3"),y(s,"class","svelte-xxdyl3"),y(f,"class","svelte-xxdyl3"),y(r,"class","svelte-xxdyl3"),y(u,"class","svelte-xxdyl3")},m($,k){D($,e,k),m(e,n),D($,t,k),D($,r,k),m(r,s),m(s,i),m(r,o),m(r,f),m(f,a),D($,d,k),D($,u,k),Z(c,u,null),v=!0,E||(_=[X(s,"click",l[3]),X(f,"click",l[6])],E=!0)},p($,k){const B={};k&2&&(B.data=$[1]),c.$set(B)},i($){v||(J(c.$$.fragment,$),v=!0)},o($){j(c.$$.fragment,$),v=!1},d($){$&&p(e),$&&p(t),$&&p(r),$&&p(d),$&&p(u),K(c),E=!1,ie(_)}}}function yt(l){let e;return{c(){e=M("下载中。。。")},l(n){e=T(n,"下载中。。。")},m(n,t){D(n,e,t)},d(n){n&&p(e)}}}function wt(l){let e,n,t,r,s,i,o,f,a,d,u,c,v,E,_,$,k,B,x,O,H,z,b,g,P;return{c(){e=L("p"),n=M(`快乐小方编写的MCBBS
			CreditAnalysis是闭源软件，因此无法直接提供带洞穴夜莺补丁的MCBBS
			CreditAnalysis。`),t=W(),r=L("p"),s=M("如果选择继续，则本页面会分别下载"),i=L("a"),o=M("MCBBS CreditAnalysis"),f=M("和"),a=L("a"),d=M("洞穴夜莺补丁"),u=M(`，然后将补丁打到MCBBS
			CreditAnalysis上。`),c=W(),v=L("p"),E=M("需要"),_=L("a"),$=M("TamperMonkey"),k=M(`浏览器插件才能使用MCBBS
			CreditAnalysis。由于技术原因，此类由网页生成的脚本无法打开TamperMonkey的安装界面。因此，在下载完成后需要您手动将脚本复制粘贴到TamperMonkey的“添加新脚本”页面（可在TamperMonkey主菜单中找到）中去安装。`),B=W(),x=L("button"),O=M("确定"),H=W(),z=L("button"),b=M("取消"),this.h()},l(h){e=A(h,"P",{class:!0});var C=F(e);n=T(C,`快乐小方编写的MCBBS
			CreditAnalysis是闭源软件，因此无法直接提供带洞穴夜莺补丁的MCBBS
			CreditAnalysis。`),C.forEach(p),t=G(h),r=A(h,"P",{class:!0});var N=F(r);s=T(N,"如果选择继续，则本页面会分别下载"),i=A(N,"A",{href:!0,class:!0});var V=F(i);o=T(V,"MCBBS CreditAnalysis"),V.forEach(p),f=T(N,"和"),a=A(N,"A",{href:!0,class:!0});var q=F(a);d=T(q,"洞穴夜莺补丁"),q.forEach(p),u=T(N,`，然后将补丁打到MCBBS
			CreditAnalysis上。`),N.forEach(p),c=G(h),v=A(h,"P",{class:!0});var I=F(v);E=T(I,"需要"),_=A(I,"A",{href:!0,class:!0});var w=F(_);$=T(w,"TamperMonkey"),w.forEach(p),k=T(I,`浏览器插件才能使用MCBBS
			CreditAnalysis。由于技术原因，此类由网页生成的脚本无法打开TamperMonkey的安装界面。因此，在下载完成后需要您手动将脚本复制粘贴到TamperMonkey的“添加新脚本”页面（可在TamperMonkey主菜单中找到）中去安装。`),I.forEach(p),B=G(h),x=A(h,"BUTTON",{class:!0});var U=F(x);O=T(U,"确定"),U.forEach(p),H=G(h),z=A(h,"BUTTON",{class:!0});var S=F(z);b=T(S,"取消"),S.forEach(p),this.h()},h(){y(e,"class","svelte-xxdyl3"),y(i,"href",Oe),y(i,"class","svelte-xxdyl3"),y(a,"href",Pe),y(a,"class","svelte-xxdyl3"),y(r,"class","svelte-xxdyl3"),y(_,"href","https://www.tampermonkey.net/"),y(_,"class","svelte-xxdyl3"),y(v,"class","svelte-xxdyl3"),y(x,"class","svelte-xxdyl3"),y(z,"class","svelte-xxdyl3")},m(h,C){D(h,e,C),m(e,n),D(h,t,C),D(h,r,C),m(r,s),m(r,i),m(i,o),m(r,f),m(r,a),m(a,d),m(r,u),D(h,c,C),D(h,v,C),m(v,E),m(v,_),m(_,$),m(v,k),D(h,B,C),D(h,x,C),m(x,O),D(h,H,C),D(h,z,C),m(z,b),g||(P=[X(x,"click",l[2]),X(z,"click",l[5])],g=!0)},p:fe,d(h){h&&p(e),h&&p(t),h&&p(r),h&&p(c),h&&p(v),h&&p(B),h&&p(x),h&&p(H),h&&p(z),g=!1,ie(P)}}}function bt(l){let e,n,t,r;const s=[vt,_t,mt,ht,dt],i=[];function o(f,a){return f[0]=="none"?0:f[0]=="confirm"?1:f[0]=="pending"?2:f[0]=="data"?3:f[0]=="error"?4:-1}return~(e=o(l))&&(n=i[e]=s[e](l)),{c(){n&&n.c(),t=se()},l(f){n&&n.l(f),t=se()},m(f,a){~e&&i[e].m(f,a),D(f,t,a),r=!0},p(f,[a]){let d=e;e=o(f),e===d?~e&&i[e].p(f,a):(n&&(Ae(),j(i[d],1,1,()=>{i[d]=null}),De()),~e?(n=i[e],n?n.p(f,a):(n=i[e]=s[e](f),n.c()),J(n,1),n.m(t.parentNode,t)):n=null)},i(f){r||(J(n),r=!0)},o(f){j(n),r=!1},d(f){~e&&i[e].d(f),f&&p(t)}}}const Oe="https://greasyfork.org/scripts/407846-mcbbs-creditanalysis/code/MCBBS%20CreditAnalysis.user.js",Pe="/assets/creditchart/userscript.patch";function Et(l,e,n){let t="none",r="";function s(){return n(0,t="pending"),Promise.all([fetch(Oe).then(d=>d.text()),fetch(Pe).then(d=>d.text())]).then(([d,u])=>{n(1,r=pt(d,u)),n(0,t="data")}).catch(d=>{n(0,t="error"),n(1,r=d.stack)})}function i(){navigator.clipboard.writeText(r),je("已复制脚本")}return[t,r,s,i,()=>n(0,t="confirm"),()=>n(0,t="none"),()=>n(0,t="none")]}class Ct extends ae{constructor(e){super(),ce(this,e,Et,bt,pe,{})}}function Be(l,e,n){const t=l.slice();return t[20]=e[n],t}function Ie(l,e,n){const t=l.slice();return t[23]=e[n],t}function Me(l){let e,n=l[0].userGroupEx,t=[];for(let r=0;r<n.length;r+=1)t[r]=Te(Ie(l,n,r));return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=se()},l(r){for(let s=0;s<t.length;s+=1)t[s].l(r);e=se()},m(r,s){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(r,s);D(r,e,s)},p(r,s){if(s&1){n=r[0].userGroupEx;let i;for(i=0;i<n.length;i+=1){const o=Ie(r,n,i);t[i]?t[i].p(o,s):(t[i]=Te(o),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=n.length}},d(r){xe(t,r),r&&p(e)}}}function Te(l){let e,n,t=l[23]+"",r;return{c(){e=M("，"),n=new Se(!1),r=se(),this.h()},l(s){e=T(s,"，"),n=Ue(s,!1),r=se(),this.h()},h(){n.a=r},m(s,i){D(s,e,i),n.m(t,s,i),D(s,r,i)},p(s,i){i&1&&t!==(t=s[23]+"")&&n.p(t)},d(s){s&&p(e),s&&p(r),s&&n.d()}}}function Le(l){let e,n,t,r,s,i=l[20][1]+"",o,f,a,d=l[5][l[20][1]]+"",u,c,v,E=(100*l[5][l[20][1]]*l[20][2]/l[1]).toFixed(2)+"",_,$,k,B,x=me(l[5][l[20][1]],l[20][3])+"",O,H,z,b,g;function P(){return l[13](l[20])}return{c(){e=L("div"),n=L("div"),t=L("div"),r=W(),s=L("div"),o=M(i),f=W(),a=L("div"),u=M(d),c=W(),v=L("div"),_=M(E),$=M("%"),k=W(),B=L("div"),O=M(x),H=W(),this.h()},l(h){e=A(h,"DIV",{class:!0,style:!0});var C=F(e);n=A(C,"DIV",{class:!0});var N=F(n);t=A(N,"DIV",{class:!0,style:!0}),F(t).forEach(p),N.forEach(p),r=G(C),s=A(C,"DIV",{class:!0});var V=F(s);o=T(V,i),V.forEach(p),f=G(C),a=A(C,"DIV",{class:!0});var q=F(a);u=T(q,d),q.forEach(p),c=G(C),v=A(C,"DIV",{class:!0});var I=F(v);_=T(I,E),$=T(I,"%"),I.forEach(p),k=G(C),B=A(C,"DIV",{class:!0});var w=F(B);O=T(w,x),w.forEach(p),H=G(C),C.forEach(p),this.h()},h(){y(t,"class","color-example svelte-3f2djp"),he(t,"background-color",l[20][0]),y(n,"class","color svelte-3f2djp"),y(s,"class","name svelte-3f2djp"),y(a,"class","count svelte-3f2djp"),y(v,"class","percent svelte-3f2djp"),y(B,"class","rank svelte-3f2djp"),y(e,"class","lines svelte-3f2djp"),y(e,"style",z=l[6]===l[20][1]?"background: #d8d8d8;":"")},m(h,C){D(h,e,C),m(e,n),m(n,t),m(e,r),m(e,s),m(s,o),m(e,f),m(e,a),m(a,u),m(e,c),m(e,v),m(v,_),m(v,$),m(e,k),m(e,B),m(B,O),m(e,H),b||(g=[X(e,"click",P),X(e,"keypress",Lt)],b=!0)},p(h,C){l=h,C&32&&d!==(d=l[5][l[20][1]]+"")&&re(u,d),C&34&&E!==(E=(100*l[5][l[20][1]]*l[20][2]/l[1]).toFixed(2)+"")&&re(_,E),C&32&&x!==(x=me(l[5][l[20][1]],l[20][3])+"")&&re(O,x),C&64&&z!==(z=l[6]===l[20][1]?"background: #d8d8d8;":"")&&y(e,"style",z)},d(h){h&&p(e),b=!1,ie(g)}}}function kt(l){let e,n,t=l[0].username+"",r,s,i,o,f=l[0].userGroup+"",a,d,u,c,v,E,_,$,k,B,x,O,H,z,b,g=me(l[1],l[7])+"",P,h,C,N,V=l[0].userGroupEx&&Me(l),q=l[8],I=[];for(let w=0;w<q.length;w+=1)I[w]=Le(Be(l,q,w));return{c(){e=L("div"),n=L("a"),r=M(t),i=M(`
		(
		`),o=new Se(!1),a=se(),V&&V.c(),d=M(`
		)
		`),u=L("div"),c=L("div"),v=W(),E=L("div"),_=M("总积分"),$=W(),k=L("div"),B=M(l[1]),x=W(),O=L("div"),H=M("100.00%"),z=W(),b=L("div"),P=M(g),h=W();for(let w=0;w<I.length;w+=1)I[w].c();this.h()},l(w){e=A(w,"DIV",{class:!0});var U=F(e);n=A(U,"A",{style:!0,href:!0,target:!0});var S=F(n);r=T(S,t),S.forEach(p),i=T(U,`
		(
		`),o=Ue(U,!1),a=se(),V&&V.l(U),d=T(U,`
		)
		`),u=A(U,"DIV",{class:!0});var R=F(u);c=A(R,"DIV",{class:!0}),F(c).forEach(p),v=G(R),E=A(R,"DIV",{class:!0});var ee=F(E);_=T(ee,"总积分"),ee.forEach(p),$=G(R),k=A(R,"DIV",{class:!0});var oe=F(k);B=T(oe,l[1]),oe.forEach(p),x=G(R),O=A(R,"DIV",{class:!0});var ne=F(O);H=T(ne,"100.00%"),ne.forEach(p),z=G(R),b=A(R,"DIV",{class:!0});var ye=F(b);P=T(ye,g),ye.forEach(p),R.forEach(p),h=G(U);for(let _e=0;_e<I.length;_e+=1)I[_e].l(U);U.forEach(p),this.h()},h(){he(n,"font-size","24px"),he(n,"color","black"),y(n,"href",s="https://www.mcbbs.net/home.php?mod=space&username="+l[0].username),y(n,"target","_blank"),o.a=a,y(c,"class","color svelte-3f2djp"),y(E,"class","name svelte-3f2djp"),y(k,"class","count svelte-3f2djp"),y(O,"class","percent svelte-3f2djp"),y(b,"class","rank svelte-3f2djp"),y(u,"class","lines svelte-3f2djp"),y(e,"class","parent svelte-3f2djp")},m(w,U){D(w,e,U),m(e,n),m(n,r),m(e,i),o.m(f,e),m(e,a),V&&V.m(e,null),m(e,d),m(e,u),m(u,c),m(u,v),m(u,E),m(E,_),m(u,$),m(u,k),m(k,B),m(u,x),m(u,O),m(O,H),m(u,z),m(u,b),m(b,P),m(e,h);for(let S=0;S<I.length;S+=1)I[S]&&I[S].m(e,null);C||(N=[X(u,"click",l[12]),X(u,"keypress",Tt)],C=!0)},p(w,U){if(U&1&&t!==(t=w[0].username+"")&&re(r,t),U&1&&s!==(s="https://www.mcbbs.net/home.php?mod=space&username="+w[0].username)&&y(n,"href",s),U&1&&f!==(f=w[0].userGroup+"")&&o.p(f),w[0].userGroupEx?V?V.p(w,U):(V=Me(w),V.c(),V.m(e,d)):V&&(V.d(1),V=null),U&2&&re(B,w[1]),U&2&&g!==(g=me(w[1],w[7])+"")&&re(P,g),U&2402){q=w[8];let S;for(S=0;S<q.length;S+=1){const R=Be(w,q,S);I[S]?I[S].p(R,U):(I[S]=Le(R),I[S].c(),I[S].m(e,null))}for(;S<I.length;S+=1)I[S].d(1);I.length=q.length}},d(w){w&&p(e),V&&V.d(),xe(I,w),C=!1,ie(N)}}}function Bt(l){let e,n,t,r,s;return{c(){e=L("div"),n=L("canvas"),t=M("请更新浏览器！"),this.h()},l(i){e=A(i,"DIV",{class:!0});var o=F(e);n=A(o,"CANVAS",{width:!0,height:!0});var f=F(n);t=T(f,"请更新浏览器！"),f.forEach(p),o.forEach(p),this.h()},h(){y(n,"width",l[4]),y(n,"height",l[4]),y(e,"class","canvas-parent svelte-3f2djp")},m(i,o){D(i,e,o),m(e,n),m(n,t),l[14](n),l[15](e),r||(s=[X(e,"click",l[10]),X(e,"keypress",At)],r=!0)},p(i,o){o&16&&y(n,"width",i[4]),o&16&&y(n,"height",i[4])},d(i){i&&p(e),l[14](null),l[15](null),r=!1,ie(s)}}}function It(l){let e,n,t,r,s,i;return e=new te({props:{$$slots:{default:[kt]},$$scope:{ctx:l}}}),t=new te({props:{$$slots:{default:[Bt]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment),n=W(),Y(t.$$.fragment)},l(o){Q(e.$$.fragment,o),n=G(o),Q(t.$$.fragment,o)},m(o,f){Z(e,o,f),D(o,n,f),Z(t,o,f),r=!0,s||(i=X(window,"resize",l[9]),s=!0)},p(o,[f]){const a={};f&67108963&&(a.$$scope={dirty:f,ctx:o}),e.$set(a);const d={};f&67108892&&(d.$$scope={dirty:f,ctx:o}),t.$set(d)},i(o){r||(J(e.$$.fragment,o),J(t.$$.fragment,o),r=!0)},o(o){j(e.$$.fragment,o),j(t.$$.fragment,o),r=!1},d(o){K(e,o),o&&p(n),K(t,o),s=!1,i()}}}function me(l,e){return l>=e[0]?"A":l>=e[1]?"B":l>=e[2]?"C":l>=0?"D":"E"}function Mt(l){let e=(l+Math.PI/2)%(Math.PI*2);return e<0&&(e+=Math.PI*2),e-Math.PI/2}const Tt=()=>{},Lt=()=>{},At=()=>{};function Dt(l,e,n){const t=[12564,7348,4827],r=[["#2dc6c8","人气",3,[1770,829,395]],["#5daf7a","金粒",0,[23372,14581,9110]],["#9c3a4b","金锭",0,[72,40,23]],["#3866b9","宝石",0,[20,9,5]],["#82de76","下界之心",0,[8,4,1]],["#b6a2dd","贡献",10,[61,21,6]],["#5ab1ee","爱心",4,[139,51,18]],["#d7797f","钻石",2,[2641,2014,1531]],["#e6399b","发帖数",1/3,[6677,3504,1911]],["#9f3ed5","主题数",2,[262,166,103]],["#ff4040","精华数",45,[20,3,0]]];let{renderingUser:s}=e,i,o,f=600,a=0,d={},u=0,c,v="",E;function _(){let b=getComputedStyle(i).width;n(4,f=Math.min(parseInt(/^([\s\S]+)px$/.exec(b)[1])-48,600)),$(),E=setInterval($,30)}function $(b=!1){if(!o)return;b&&n(6,v=""),u===1&&(clearInterval(E),E=0),u+=.03,u>=1&&(u=1);let g=o.getContext("2d"),P=0,h=f/2;g.clearRect(0,0,f,f);for(let[C,N,V]of r){if(V==0||d[N]==0)continue;g.fillStyle=C,g.strokeStyle=C,g.lineWidth=2,g.font="400 "+f/60+"px serif";let q=Math.abs(a),I=2*Math.PI*(P/q*u-1/4),w=2*Math.PI*((P+=d[N]*V)/q*u-1/4);I>w&&([I,w]=[w,I]);let U=(I+w)/2;b&&c>I&&c<w&&n(6,v=N);let S=N===v?f/2.7:f/3,R=h+Math.cos(U)*f/2.5,ee=h+Math.sin(U)*f/2.5,oe=(100*d[N]*V/a).toFixed(2)+"%";if(g.beginPath(),g.moveTo(h,h),g.arc(h,h,S,I,w),g.closePath(),g.fill(),g.moveTo(h,h),g.lineTo(R,ee),g.stroke(),Mt(U)>Math.PI/2){let ne=R-f/10;g.lineTo(ne,ee),g.fillText(N+d[N],ne,ee-f/120),g.fillText(oe,ne,ee+f/40),g.stroke()}else{let ne=R+f/10;g.lineTo(ne,ee),g.fillText(N+d[N],R,ee-f/120),g.fillText(oe,R,ee+f/40),g.stroke()}}}function k(b){let g=f/2,P=b.offsetX-g,h=b.offsetY-g,C=(P**2+h**2)**.5;if(C<=f/2.6){let N=P/C;c=h/C>=0?Math.acos(N):2*Math.PI-Math.acos(N),c=c>=3*Math.PI/2?c-2*Math.PI:c,$(!0)}else c=void 0,$(!0)}function B(b){n(6,v=b),$()}Fe(_),Ge(()=>E!=0?clearInterval(E):0);const x=()=>B(""),O=b=>B(b[1]);function H(b){we[b?"unshift":"push"](()=>{o=b,n(3,o)})}function z(b){we[b?"unshift":"push"](()=>{i=b,n(2,i)})}return l.$$set=b=>{"renderingUser"in b&&n(0,s=b.renderingUser)},l.$$.update=()=>{if(l.$$.dirty&3){n(1,a=s.credits.积分);let b={},g=0;for(let P of r){let h;switch(P[1]){case"发帖数":h=s.posts+s.threads;break;case"主题数":h=s.threads;break;case"精华数":h=(a-g)/45;break;default:h=s.credits[P[1]]}b[P[1]]=h,g+=Math.floor(h*P[2]+.5)}n(5,d=b)}},[s,a,i,o,f,d,v,t,r,_,k,B,x,O,H,z]}class Ft extends ae{constructor(e){super(),ce(this,e,Dt,It,pe,{renderingUser:0})}}function St(l){let e,n,t,r,s,i;return{c(){e=M(`输入用户的UID：
		`),n=L("input"),t=L("button"),r=M("确定"),this.h()},l(o){e=T(o,`输入用户的UID：
		`),n=A(o,"INPUT",{type:!0,class:!0}),t=A(o,"BUTTON",{class:!0});var f=F(t);r=T(f,"确定"),f.forEach(p),this.h()},h(){y(n,"type","number"),y(n,"class","svelte-1vc10mp"),y(t,"class","svelte-1vc10mp")},m(o,f){D(o,e,f),D(o,n,f),Ee(n,l[1]),D(o,t,f),m(t,r),s||(i=[X(n,"input",l[3]),X(t,"click",l[2])],s=!0)},p(o,f){f&2&&Ve(n.value)!==o[1]&&Ee(n,o[1])},d(o){o&&p(e),o&&p(n),o&&p(t),s=!1,ie(i)}}}function Ut(l){let e,n;return e=new Ft({props:{renderingUser:l[0]}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.renderingUser=t[0]),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function xt(l){let e,n;return e=new Ct({}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p:fe,i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Vt(l){let e,n;return e=new te({props:{$$slots:{default:[Nt]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&128&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function zt(l){let e,n;return e=new te({props:{$$slots:{default:[Ot]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,r){const s={};r&128&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Nt(l){let e;return{c(){e=M("加载中。。。")},l(n){e=T(n,"加载中。。。")},m(n,t){D(n,e,t)},d(n){n&&p(e)}}}function Ot(l){let e,n;return{c(){e=L("span"),n=M("找不到这个用户"),this.h()},l(t){e=A(t,"SPAN",{style:!0});var r=F(e);n=T(r,"找不到这个用户"),r.forEach(p),this.h()},h(){he(e,"color","red")},m(t,r){D(t,e,r),m(e,n)},p:fe,d(t){t&&p(e)}}}function Pt(l){let e;return{c(){e=M("说明：等级判定与排位有关，前150名判为A级，前400名判为B级，前1000名判为C级，除此之外大于等于零的判D级，小于零的判E级。采用2022年4月xmdhs统计数据。页面使用的跨域代理为https://master--cavenightingale.netlify.app/.netlify/functions/get-mcbbs-credit?uid=，Netlify超时时间长达10秒而且访问MCBBS速度较慢，故可能出现长时间加载的情况，可以尝试再次点击“确定”。")},l(n){e=T(n,"说明：等级判定与排位有关，前150名判为A级，前400名判为B级，前1000名判为C级，除此之外大于等于零的判D级，小于零的判E级。采用2022年4月xmdhs统计数据。页面使用的跨域代理为https://master--cavenightingale.netlify.app/.netlify/functions/get-mcbbs-credit?uid=，Netlify超时时间长达10秒而且访问MCBBS速度较慢，故可能出现长时间加载的情况，可以尝试再次点击“确定”。")},m(n,t){D(n,e,t)},d(n){n&&p(e)}}}function Ht(l){let e,n,t,r,s,i,o;e=new te({props:{$$slots:{default:[St]},$$scope:{ctx:l}}});const f=[zt,Vt,xt,Ut],a=[];function d(u,c){return u[0]==="error"?0:u[0]==="pending"?1:u[0]==="none"?2:3}return t=d(l),r=a[t]=f[t](l),i=new et({props:{$$slots:{default:[Pt]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment),n=W(),r.c(),s=W(),Y(i.$$.fragment)},l(u){Q(e.$$.fragment,u),n=G(u),r.l(u),s=G(u),Q(i.$$.fragment,u)},m(u,c){Z(e,u,c),D(u,n,c),a[t].m(u,c),D(u,s,c),Z(i,u,c),o=!0},p(u,c){const v={};c&130&&(v.$$scope={dirty:c,ctx:u}),e.$set(v);let E=t;t=d(u),t===E?a[t].p(u,c):(Ae(),j(a[E],1,1,()=>{a[E]=null}),De(),r=a[t],r?r.p(u,c):(r=a[t]=f[t](u),r.c()),J(r,1),r.m(s.parentNode,s));const _={};c&128&&(_.$$scope={dirty:c,ctx:u}),i.$set(_)},i(u){o||(J(e.$$.fragment,u),J(r),J(i.$$.fragment,u),o=!0)},o(u){j(e.$$.fragment,u),j(r),j(i.$$.fragment,u),o=!1},d(u){K(e,u),u&&p(n),a[t].d(u),u&&p(s),K(i,u)}}}function Rt(l){let e,n;return e=new Qe({props:{$$slots:{default:[Ht]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,r){Z(e,t,r),n=!0},p(t,[r]){const s={};r&131&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}const qt="https://master--cavenightingale.netlify.app/.netlify/functions/get-mcbbs-credit?uid=";async function Wt(l){let e,n=0;for(;!e&&n++<3;)try{e=await(await fetch(qt+l)).json()}catch{}if(e){if(e.error)throw new Error(e.error);if(e.username)return e;throw new Error("Function returns improper data")}else throw new Error("Cannot connect to proxy")}function Gt(l,e,n){let t;Je(l,ve,d=>n(4,t=d));let r=()=>{i!="none"?(n(0,i="none"),history.pushState({},"","/creditchart")):open("/","_self")},s="",i="none";async function o(d,u=!0){let c=parseInt(s);if(isFinite(c)&&c>0){n(0,i="pending");try{n(0,i=await Wt(c)),u&&history.pushState({},"",location.pathname+"?uid="+c)}catch{n(0,i="error")}}else n(0,i="error")}function f(){n(1,s=new URLSearchParams(location.search).get("uid")||""),s!=""?o(0,!1):n(0,i="none")}Fe(f),Xe("MCBBS积分分析",r);function a(){s=Ve(this.value),n(1,s)}return l.$$.update=()=>{if(l.$$.dirty&1)switch(i){case"none":case"pending":case"error":be(ve,t="MCBBS积分分析",t);break;default:be(ve,t="MCBBS积分分析 - "+i.username,t)}},[i,s,o,a]}class Zt extends ae{constructor(e){super(),ce(this,e,Gt,Rt,pe,{})}}export{Zt as component};
